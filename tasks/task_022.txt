# Task ID: 22
# Title: Implement Dagster schedules for daily updates
# Status: pending
# Dependencies: 20, 21
# Priority: medium
# Description: Create Dagster schedules to automatically update the bronze layer data on a daily basis during the basketball season.
# Details:
1. Update ncaa_basketball_pipeline/definitions.py to include schedules:
```python
from dagster import Definitions, ScheduleDefinition, define_asset_job
from dagster_embedded_elt.dlt import DagsterDltResource

from .assets import espn_bronze_assets_definition, espn_bronze_partitioned_assets_definition

# Define jobs for the assets
full_bronze_job = define_asset_job(name="full_bronze_job", selection="bronze_espn_assets")
daily_bronze_job = define_asset_job(
    name="daily_bronze_job",
    selection="bronze_espn_partitioned_assets",
    partitions_def_override={
        "bronze_espn_partitioned_assets": lambda: datetime.now().strftime("%Y-%m-%d")
    }
)

# Define schedules
daily_schedule = ScheduleDefinition(
    job=daily_bronze_job,
    cron_schedule="0 5 * * *",  # Run at 5:00 AM every day
    execution_timezone="UTC",
)

# Define the DagsterDltResource
dlt_resource = DagsterDltResource()

# Create the Definitions object with assets, jobs, schedules, and resources
defs = Definitions(
    assets=[espn_bronze_assets_definition, espn_bronze_partitioned_assets_definition],
    jobs=[full_bronze_job, daily_bronze_job],
    schedules=[daily_schedule],
    resources={
        "dlt_resource": dlt_resource,
    }
)
```
2. This creates a daily schedule that runs at 5:00 AM UTC every day to update the bronze layer with the latest data.

# Test Strategy:
Test that the schedules can be registered successfully. Verify that the scheduled jobs run at the expected times and materialize the correct assets. Test that the partitioning works correctly when triggered by the schedule.
